
-- technologies not included, need to revisit: WooCommerce,Squarespace Commerce, Easy Digital Downloads,WP eCommerce,Taobao,WordPress eStore Plugin
--all technologies not in automtive,non-platform,plugin/module,smb solution,wordpress theme with min of 1000 websites selected below

--normal join gives 4.9L, but many not ecommerce

--check domains which have >1 ecom techs
select count(distinct company_url)
from builtwith_company_technologies_march_dump where 
lower(company_url) not in (select domain from ecommerce_data) 
and array['3D Cart', 'AbleCommerce', 'Actinic', 'Big Cartel', 'BigCommerce', 'CCV Shop', 'Cart66', 'CubeCart', 'Demandware', 'Drupal Commerce', 'ECSHOP', 'GoDaddy Online Store', 'GoDaddy Quick Shopping Cart', 'Hybris', 'IBM Websphere Commerce', 'InSales', 'K-eCommerce', 'Loja Integrada', 'Magento', 'Magento Enterprise', 'Miva Merchant', 'MyStore NO', 'NetSuite eCommerce', 'Nuvem Shop', 'OXID EShop Community', 'OXID Eshop Enterprise', 'OpenCart', 'Oracle Commerce', 'Pinnacle Cart', 'PlentyMarkets', 'PrestaShop', 'SOTE', 'ShopGo', 'Shoper', 'Shopify', 'Shopify Plus', 'Shopline', 'Shoplo', 'Shopware', 'Spark Pay', 'Spree', 'Storenvy', 'Tienda Nube', 'TomatoCart', 'Ubercart', 'UltraCart', 'VP-ASP', 'VTEX', 'VTEX Integrated Store', 'VirtueMart', 'Volusion', 'Weebly eCommerce', 'Yahoo Store', 'Zeald', 'Zen Cart', 'ePages', 'ekmPowershop', 'nopCommerce', 'osCommerce'] && technologies and 
array_length(array_intersect(array['3D Cart', 'AbleCommerce', 'Actinic', 'Big Cartel', 'BigCommerce', 'CCV Shop', 'Cart66', 'CubeCart', 'Demandware', 'Drupal Commerce', 'ECSHOP', 'GoDaddy Online Store', 'GoDaddy Quick Shopping Cart', 'Hybris', 'IBM Websphere Commerce', 'InSales', 'K-eCommerce', 'Loja Integrada', 'Magento', 'Magento Enterprise', 'Miva Merchant', 'MyStore NO', 'NetSuite eCommerce', 'Nuvem Shop', 'OXID EShop Community', 'OXID Eshop Enterprise', 'OpenCart', 'Oracle Commerce', 'Pinnacle Cart', 'PlentyMarkets', 'PrestaShop', 'SOTE', 'ShopGo', 'Shoper', 'Shopify', 'Shopify Plus', 'Shopline', 'Shoplo', 'Shopware', 'Spark Pay', 'Spree', 'Storenvy', 'Tienda Nube', 'TomatoCart', 'Ubercart', 'UltraCart', 'VP-ASP', 'VTEX', 'VTEX Integrated Store', 'VirtueMart', 'Volusion', 'Weebly eCommerce', 'Yahoo Store', 'Zeald', 'Zen Cart', 'ePages', 'ekmPowershop', 'nopCommerce', 'osCommerce'],technologies),1)>1;
--8715

--add more techs into this (min 100 websites and in ecom category)
select count(distinct company_url) from builtwith_company_technologies_march_dump where lower(company_url) not in (select domain from ecommerce_data) and array['3D Cart', 'AbleCommerce', 'Actinic', 'Big Cartel', 'BigCommerce', 'CCV Shop', 'Cart66', 'CubeCart', 'Demandware', 'Drupal Commerce', 'ECSHOP', 'GoDaddy Online Store', 'GoDaddy Quick Shopping Cart', 'Hybris', 'IBM Websphere Commerce', 'InSales', 'K-eCommerce', 'Loja Integrada', 'Magento', 'Magento Enterprise', 'Miva Merchant', 'MyStore NO', 'NetSuite eCommerce', 'Nuvem Shop', 'OXID EShop Community', 'OXID Eshop Enterprise', 'OpenCart', 'Oracle Commerce', 'Pinnacle Cart', 'PlentyMarkets', 'PrestaShop', 'SOTE', 'ShopGo', 'Shoper', 'Shopify', 'Shopify Plus', 'Shopline', 'Shoplo', 'Shopware', 'Spark Pay', 'Spree', 'Storenvy', 'Tienda Nube', 'TomatoCart', 'Ubercart', 'UltraCart', 'VP-ASP', 'VTEX', 'VTEX Integrated Store', 'VirtueMart', 'Volusion', 'Weebly eCommerce', 'Yahoo Store', 'Zeald', 'Zen Cart', 'ePages', 'ekmPowershop', 'nopCommerce', 'osCommerce'] && technologies and array_length(array_intersect(array['1ShoppingCart', '3D Cart', 'ARI', 'AbleCommerce', 'AceShop OpenCart', 'Actinic', 'AdVantShop', 'Agency', 'Amazon Webstore', 'Americart', 'Arastta', 'Ascentium Commerce Server', 'AspDotNetStorefront', 'Aspidistra Shopfront', 'Atahualpa', 'Avactis', 'Avada', 'BV Commerce', 'BeTheme', 'Beetailer', 'Big Cartel', 'BigCommerce', 'Blog Theme', 'Braxton', 'Bridge', 'BuildaBazaar', 'CCV Shop', 'CS Cart', 'CSN', 'Canvas Theme', 'CarNow', 'Cart Functionality', 'Cart66', 'CheryFramework', 'CiaShop', 'Codeblackbelt', 'Compare', 'Construct', 'CoreCommerce', 'CubeCart', 'Curated', 'Cutomizr', 'Dandomain Webshop', 'Dealer Spike', 'DealerInspire', 'DealerOn', 'Demandware', 'DirektOnline', 'Divi', 'Drupal Commerce', 'Drupal Commerce Extra', 'DukaPress', 'Dynamic Converter', 'Dynamik', 'E-junkie', 'E37', 'ECSHOP', 'EZ Commerce', 'Easy Digital Downloads', 'Ecwid', 'Education Center', 'Elastic Path', 'Enfold', 'Etsy', 'Examiner', 'Ezimerchant', 'FastSpring', 'Fearless', 'Flex Mag', 'Flexform', 'Florence', 'Foodie Pro', 'FotoMoto', 'FoxyCart', 'GekoSale', 'GeneratePress', 'Genesis Framework', 'GetShopped', 'GoDaddy Online Store', 'GoDaddy Quick Shopping Cart', 'Gonzo', 'Goodsie', 'GrandNews', 'Headway Themes', 'Hemlock', 'Highwire Commerce', 'Hot Topix', 'Hueman', 'Hybrid', 'Hybris', 'IBM Websphere Commerce', 'Iconic One', 'Iluria', 'Impreza', 'InSales', 'Interchange', 'Intershop', 'Interspire', 'Isotools', 'Jarida', 'Jetshop', 'Jigoshop', 'Jumpseller', 'Jupiter', 'JustAddCommerce', 'K-eCommerce', 'KartRocket', 'KnowHow', 'Kryptronic', 'Layers', 'LemonStand', 'Lengow', 'LifeStyle', 'Literatum', 'Litium', 'Loaded Commerce', 'LogiCommerce', 'Loja Integrada', 'Loja Mestre', 'Loja2', 'MH Magazine', 'Mabisy', 'Magazine', 'Magazine Pro', 'Magento', 'Magento 1.2', 'Magento 1.3', 'Magento 1.4', 'Magento 1.5', 'Magento 1.6', 'Magento 1.7', 'Magento 1.8', 'Magento 1.9', 'Magento 2', 'Magento 2 Community', 'Magento 2 Enterprise', 'Magento 2.0', 'Magento 2.1', 'Magento Enterprise', 'MarketPress', 'Martjack', 'Massive Dynamic', 'Max Mag', 'Metro Pro', 'Miiduu', 'Miva Merchant', 'Modern Blogger Pro', 'Modernize', 'MyPlay', 'MyStore NO', 'Mystique', 'NanoMag', 'NetSuite eCommerce', 'Netset', 'Network Solutions Commerce', 'News Pro', 'Newsmag', 'Nexternal', 'NitroSell', 'Nordisk E-handel', 'Novomag', 'Nuvem Shop', 'OXID EShop', 'OXID EShop Community', 'OXID Eshop Enterprise', 'Oasis 7', 'Octave', 'Office', 'OpenCart', 'Oracle Commerce', 'Origin', 'Outreach Pro', 'PageLines', 'Peel', 'Permatex', 'Pinnacle Cart', 'Platform Pro', 'PlentyMarkets', 'Pressroom', 'PrestaShop', 'ProductCart', 'RPMWare', 'Redicom', 'Right Way', 'SOTE', 'Sahifa', 'Salient', 'SearchFit', 'Sellect', 'Sellfy', 'Selly Shop', 'Selz', 'Sensei', 'ShopDirect', 'ShopGate', 'ShopGo', 'ShopMatic', 'ShopRenter', 'ShopSite', 'Shoper', 'Shopify', 'Shopify Australian Dollar', 'Shopify British Pound', 'Shopify Buy Button', 'Shopify Canadian Dollar', 'Shopify Conversions', 'Shopify Euro', 'Shopify New Zealand Dollar', 'Shopify Plus', 'Shopify US Dollar', 'Shopline', 'Shoplo', 'Shopp', 'ShopperPress', 'Shopping Cart Elite', 'Shoprocket', 'Shopware', 'Simple Cart (js)', 'SimpleMag', 'Simplicity', 'SiteBox', 'Sky Shop', 'SmartMag', 'SmartStore.NET', 'Smoolis', 'SociallyViral', 'Sophio', 'Spark Pay', 'Sparkle', 'Sparkling', 'Spree', 'Squarespace Commerce', 'Squirrelcart', 'Startit', 'Sterling', 'StoreHippo', 'Storeden', 'Storenvy', 'Suffusion', 'Summer Cart', 'Talex', 'Taobao', 'Tempera', 'The Voux', 'The7', 'Thematic', 'Thesis', 'Ticimax', 'Tienda Nube', 'Tjoos', 'TomatoCart', 'Toolbox', 'Top News', 'TradeMotion', 'Tribune', 'Twenty Eleven', 'Twenty Fifteen', 'Twenty Fourteen', 'Twenty Ten', 'Twenty Thirteen', 'Twenty Twelve', 'Twigmo', 'Ubercart', 'UltraCart', 'Uncode', 'VP-ASP', 'VTEX', 'VTEX Integrated Store', 'Valenti', 'Vend', 'Vendio', 'VirtueMart', 'Visualsoft', 'Volusion', 'WP eCommerce', 'Weaver II', 'Web Shop Manager', 'WebCollage', 'WebLinc', 'Weebly eCommerce', 'WhiteLight', 'Wikinggruppen', 'WiziShop', 'Woo Themes', 'WooCommerce', 'WooCommerce 1.3', 'WooCommerce 1.5', 'WooCommerce 1.6', 'WooCommerce 2.0', 'WooCommerce 2.1', 'WooCommerce 2.2', 'WooCommerce 2.3', 'WooCommerce Add To Cart', 'WooFramework', 'WordPress eStore Plugin', 'X-Cart', 'X-Cart 5', 'Yahoo Store', 'Yak for Wordpress', 'Zeald', 'Zen Cart', 'Zepo', 'Znode', 'Zoey', 'Zoovy', 'deTube', 'eCarList', 'ePages', 'eSellerPro', 'eShop', 'ekmPowershop', 'eleven40', 'iNove', 'iShopping', 'inFocus', 'modified ecommerce Shopsoftware', 'nopCommerce', 'nsCommerceSpace', 'osCommerce'],technologies),1)>1;
--320137

--minimum 1000 websites
set search_path to ecommerce;
select count(distinct company_url) from public.builtwith_company_technologies_march_dump a left join ecommerce.ecommerce_data b on a.company_url=b.domain where b.domain is null and array['3D Cart', 'AbleCommerce', 'Actinic', 'Big Cartel', 'BigCommerce', 'CCV Shop', 'Cart66', 'CubeCart', 'Demandware', 'Drupal Commerce', 'ECSHOP', 'GoDaddy Online Store', 'GoDaddy Quick Shopping Cart', 'Hybris', 'IBM Websphere Commerce', 'InSales', 'K-eCommerce', 'Loja Integrada', 'Magento', 'Magento Enterprise', 'Miva Merchant', 'MyStore NO', 'NetSuite eCommerce', 'Nuvem Shop', 'OXID EShop Community', 'OXID Eshop Enterprise', 'OpenCart', 'Oracle Commerce', 'Pinnacle Cart', 'PlentyMarkets', 'PrestaShop', 'SOTE', 'ShopGo', 'Shoper', 'Shopify', 'Shopify Plus', 'Shopline', 'Shoplo', 'Shopware', 'Spark Pay', 'Spree', 'Storenvy', 'Tienda Nube', 'TomatoCart', 'Ubercart', 'UltraCart', 'VP-ASP', 'VTEX', 'VTEX Integrated Store', 'VirtueMart', 'Volusion', 'Weebly eCommerce', 'Yahoo Store', 'Zeald', 'Zen Cart', 'ePages', 'ekmPowershop', 'nopCommerce', 'osCommerce'] && technologies and array_length(public.array_intersect(array['3D Cart', 'ARI', 'AbleCommerce', 'Actinic', 'Agency', 'Atahualpa', 'Avada', 'BeTheme', 'Beetailer', 'Big Cartel', 'BigCommerce', 'Braxton', 'Bridge', 'CCV Shop', 'CS Cart', 'Canvas Theme', 'Cart Functionality', 'Cart66', 'CheryFramework', 'Codeblackbelt', 'Construct', 'CubeCart', 'Cutomizr', 'Dealer Spike', 'DealerInspire', 'DealerOn', 'Demandware', 'Divi', 'Drupal Commerce', 'Dynamik', 'E-junkie', 'ECSHOP', 'Easy Digital Downloads', 'Ecwid', 'Education Center', 'Enfold', 'Etsy', 'Flex Mag', 'Flexform', 'Florence', 'Foodie Pro', 'FotoMoto', 'GeneratePress', 'Genesis Framework', 'GetShopped', 'GoDaddy Online Store', 'GoDaddy Quick Shopping Cart', 'Gonzo', 'Headway Themes', 'Hemlock', 'Hot Topix', 'Hueman', 'Hybrid', 'Hybris', 'IBM Websphere Commerce', 'Iconic One', 'Impreza', 'InSales', 'Jarida', 'Jigoshop', 'Jupiter', 'K-eCommerce', 'KnowHow', 'Layers', 'LifeStyle', 'Loja Integrada', 'MH Magazine', 'Magazine', 'Magazine Pro', 'Magento', 'Magento 1.4', 'Magento 1.5', 'Magento 1.6', 'Magento 1.7', 'Magento 1.8', 'Magento 1.9', 'Magento 2', 'Magento 2 Community', 'Magento 2 Enterprise', 'Magento 2.0', 'Magento 2.1', 'Magento Enterprise', 'MarketPress', 'Massive Dynamic', 'Max Mag', 'Metro Pro', 'Miva Merchant', 'Modern Blogger Pro', 'Modernize', 'MyStore NO', 'Mystique', 'NanoMag', 'NetSuite eCommerce', 'News Pro', 'Newsmag', 'Nuvem Shop', 'OXID EShop', 'OXID EShop Community', 'OXID Eshop Enterprise', 'Office', 'OpenCart', 'Oracle Commerce', 'Origin', 'Outreach Pro', 'PageLines', 'Pinnacle Cart', 'Platform Pro', 'PlentyMarkets', 'PrestaShop', 'Right Way', 'SOTE', 'Sahifa', 'Salient', 'Sensei', 'ShopGo', 'ShopSite', 'Shoper', 'Shopify', 'Shopify Australian Dollar', 'Shopify British Pound', 'Shopify Buy Button', 'Shopify Canadian Dollar', 'Shopify Conversions', 'Shopify Euro', 'Shopify New Zealand Dollar', 'Shopify Plus', 'Shopify US Dollar', 'Shopline', 'Shoplo', 'Shopp', 'ShopperPress', 'Shopware', 'Simple Cart (js)', 'SimpleMag', 'Simplicity', 'SmartMag', 'SociallyViral', 'Spark Pay', 'Sparkling', 'Spree', 'Squarespace Commerce', 'Startit', 'Sterling', 'Storenvy', 'Suffusion', 'Summer Cart', 'Taobao', 'Tempera', 'The Voux', 'The7', 'Thematic', 'Thesis', 'Tienda Nube', 'TomatoCart', 'Toolbox', 'Top News', 'Tribune', 'Twenty Eleven', 'Twenty Fifteen', 'Twenty Fourteen', 'Twenty Ten', 'Twenty Thirteen', 'Twenty Twelve', 'Ubercart', 'UltraCart', 'Uncode', 'VP-ASP', 'VTEX', 'VTEX Integrated Store', 'Valenti', 'VirtueMart', 'Volusion', 'WP eCommerce', 'Weaver II', 'Weebly eCommerce', 'WhiteLight', 'Woo Themes', 'WooCommerce', 'WooCommerce 2.0', 'WooCommerce 2.1', 'WooCommerce 2.2', 'WooCommerce 2.3', 'WooCommerce Add To Cart', 'WooFramework', 'WordPress eStore Plugin', 'X-Cart', 'Yahoo Store', 'Zeald', 'Zen Cart', 'deTube', 'ePages', 'eShop', 'ekmPowershop', 'eleven40', 'iNove', 'inFocus', 'modified ecommerce Shopsoftware', 'nopCommerce', 'nsCommerceSpace', 'osCommerce'],technologies),1)>1;
--319114

--create table with the urls
create table ecommerce_domains_from_bw_techs as select distinct company_url from public.builtwith_company_technologies_march_dump where lower(company_url) not in (select domain from ecommerce_data) and array['3D Cart', 'AbleCommerce', 'Actinic', 'Big Cartel', 'BigCommerce', 'CCV Shop', 'Cart66', 'CubeCart', 'Demandware', 'Drupal Commerce', 'ECSHOP', 'GoDaddy Online Store', 'GoDaddy Quick Shopping Cart', 'Hybris', 'IBM Websphere Commerce', 'InSales', 'K-eCommerce', 'Loja Integrada', 'Magento', 'Magento Enterprise', 'Miva Merchant', 'MyStore NO', 'NetSuite eCommerce', 'Nuvem Shop', 'OXID EShop Community', 'OXID Eshop Enterprise', 'OpenCart', 'Oracle Commerce', 'Pinnacle Cart', 'PlentyMarkets', 'PrestaShop', 'SOTE', 'ShopGo', 'Shoper', 'Shopify', 'Shopify Plus', 'Shopline', 'Shoplo', 'Shopware', 'Spark Pay', 'Spree', 'Storenvy', 'Tienda Nube', 'TomatoCart', 'Ubercart', 'UltraCart', 'VP-ASP', 'VTEX', 'VTEX Integrated Store', 'VirtueMart', 'Volusion', 'Weebly eCommerce', 'Yahoo Store', 'Zeald', 'Zen Cart', 'ePages', 'ekmPowershop', 'nopCommerce', 'osCommerce'] && technologies and array_length(public.array_intersect(array['3D Cart', 'ARI', 'AbleCommerce', 'Actinic', 'Agency', 'Atahualpa', 'Avada', 'BeTheme', 'Beetailer', 'Big Cartel', 'BigCommerce', 'Braxton', 'Bridge', 'CCV Shop', 'CS Cart', 'Canvas Theme', 'Cart Functionality', 'Cart66', 'CheryFramework', 'Codeblackbelt', 'Construct', 'CubeCart', 'Cutomizr', 'Dealer Spike', 'DealerInspire', 'DealerOn', 'Demandware', 'Divi', 'Drupal Commerce', 'Dynamik', 'E-junkie', 'ECSHOP', 'Easy Digital Downloads', 'Ecwid', 'Education Center', 'Enfold', 'Etsy', 'Flex Mag', 'Flexform', 'Florence', 'Foodie Pro', 'FotoMoto', 'GeneratePress', 'Genesis Framework', 'GetShopped', 'GoDaddy Online Store', 'GoDaddy Quick Shopping Cart', 'Gonzo', 'Headway Themes', 'Hemlock', 'Hot Topix', 'Hueman', 'Hybrid', 'Hybris', 'IBM Websphere Commerce', 'Iconic One', 'Impreza', 'InSales', 'Jarida', 'Jigoshop', 'Jupiter', 'K-eCommerce', 'KnowHow', 'Layers', 'LifeStyle', 'Loja Integrada', 'MH Magazine', 'Magazine', 'Magazine Pro', 'Magento', 'Magento 1.4', 'Magento 1.5', 'Magento 1.6', 'Magento 1.7', 'Magento 1.8', 'Magento 1.9', 'Magento 2', 'Magento 2 Community', 'Magento 2 Enterprise', 'Magento 2.0', 'Magento 2.1', 'Magento Enterprise', 'MarketPress', 'Massive Dynamic', 'Max Mag', 'Metro Pro', 'Miva Merchant', 'Modern Blogger Pro', 'Modernize', 'MyStore NO', 'Mystique', 'NanoMag', 'NetSuite eCommerce', 'News Pro', 'Newsmag', 'Nuvem Shop', 'OXID EShop', 'OXID EShop Community', 'OXID Eshop Enterprise', 'Office', 'OpenCart', 'Oracle Commerce', 'Origin', 'Outreach Pro', 'PageLines', 'Pinnacle Cart', 'Platform Pro', 'PlentyMarkets', 'PrestaShop', 'Right Way', 'SOTE', 'Sahifa', 'Salient', 'Sensei', 'ShopGo', 'ShopSite', 'Shoper', 'Shopify', 'Shopify Australian Dollar', 'Shopify British Pound', 'Shopify Buy Button', 'Shopify Canadian Dollar', 'Shopify Conversions', 'Shopify Euro', 'Shopify New Zealand Dollar', 'Shopify Plus', 'Shopify US Dollar', 'Shopline', 'Shoplo', 'Shopp', 'ShopperPress', 'Shopware', 'Simple Cart (js)', 'SimpleMag', 'Simplicity', 'SmartMag', 'SociallyViral', 'Spark Pay', 'Sparkling', 'Spree', 'Squarespace Commerce', 'Startit', 'Sterling', 'Storenvy', 'Suffusion', 'Summer Cart', 'Taobao', 'Tempera', 'The Voux', 'The7', 'Thematic', 'Thesis', 'Tienda Nube', 'TomatoCart', 'Toolbox', 'Top News', 'Tribune', 'Twenty Eleven', 'Twenty Fifteen', 'Twenty Fourteen', 'Twenty Ten', 'Twenty Thirteen', 'Twenty Twelve', 'Ubercart', 'UltraCart', 'Uncode', 'VP-ASP', 'VTEX', 'VTEX Integrated Store', 'Valenti', 'VirtueMart', 'Volusion', 'WP eCommerce', 'Weaver II', 'Weebly eCommerce', 'WhiteLight', 'Woo Themes', 'WooCommerce', 'WooCommerce 2.0', 'WooCommerce 2.1', 'WooCommerce 2.2', 'WooCommerce 2.3', 'WooCommerce Add To Cart', 'WooFramework', 'WordPress eStore Plugin', 'X-Cart', 'Yahoo Store', 'Zeald', 'Zen Cart', 'deTube', 'ePages', 'eShop', 'ekmPowershop', 'eleven40', 'iNove', 'inFocus', 'modified ecommerce Shopsoftware', 'nopCommerce', 'nsCommerceSpace', 'osCommerce'],technologies),1)>1 ;

alter table ecommerce_domains_from_bw_techs add column domain text;
update ecommerce_domains_from_bw_techs set domain = lower(public.get_domain_from_website(company_url));
create table ecommerce_domains_from_bw_techs_unique as select distinct a.domain from ecommerce_domains_from_bw_techs a left join ecommerce_data b using(domain) where b.domain is null ;

--insert
insert into ecommerce_data (domain,sources) select domain,array['builtwith_march_dump'] from ecommerce_domains_from_bw_techs_unique ;

--update other data 

-- add builtwith data
update ecommerce_data a set bw_technologies=b.technologies from public.builtwith_company_technologies_march_dump b where a.domain=lower(b.company_url) ;

--funding
update ecommerce_data a set funding_rounds=b.funding_rounds,funding_total_usd = b.funding_total_usd,
first_funding_on = b.first_funding_on ,last_funding_on  = b.last_funding_on
from crunchbase_data.organizations b where a.domain=lower(b.domain) and a.funding_rounds is null;

--update linkedin details 
update ecommerce_data a set 
linkedin_url=b.linkedin_url,company_name=b.company_name,company_size=b.company_size,industry=b.industry,company_type=b.company_type,
headquarters=b.headquarters,description=b.description,founded=b.founded,specialties=b.specialties,website=b.website,timestamp=b.timestamp,
employee_details_array=b.employee_details_array,also_viewed_companies_array=b.also_viewed_companies_array,
domain=c.domain,linkedin_name=c.linkedin_name,website_cleaned=c.website_cleaned,location=c.location,region=c.region,country=c.country
from public.linkedin_company_base b , public.linkedin_company_domains c 
where a.domain=c.domain and b.linkedin_url = c.linkedin_url and a.linkedin_url is null and a.domain is not null;

--alexa

update ecommerce_data a set unique_visitors=b.unique_visitors,unique_visitors_growth=b.unique_visitors_growth,pageviews=b.pageviews,time_on_site_seconds=b.time_on_site_seconds,alexa_global_rank=b.global_rank,website_language=b.language,alexa_category=b.category from public.ecommerce_companies_alexa_data b where lower(a.domain)=lower(b.site) and a.domain is not null and b.site is not null and a.unique_visitors is null;
update ecommerce_data set alexa_category=regexp_replace(alexa_category, '^.*-', '');


--product recommendation
update ecommerce_data set recomm_collab_filter = 't' where 
	array['Trustpilot', 'Nosto', 'ForeSee Results', 'ScarabResearch', 'Retail Rocket', 'SLI Systems', 'Nextopia', 'Econda', 'Certona', 'Rees46', 'Clerk', 'Commerce Sciences', 'chaordic', 'Baynote', 'Target2Sell', 'BrainSINS', 'RecoPick', 'Blueknow', 'BrainPad Rtoaster', 'Segmentify'] && bw_technologies;

--multi channel
update ecommerce_data set multi_channel_presence = 't' where 
	array['BigCommerce', 'OpenCart', 'Hybris', 'NetSuite eCommerce', 'AspDotNetStorefront', 'Intershop', 'Visualsoft', 'Martjack', 'OneStop Internet', 'BT Fresca', 'Symphony Commerce', 'Sana Commerce', 'Unilog', 'eSellerPro', 'Vendio', 'Vend', 'ROC Commerce', 'Celerant', 'Xretail', 'TotalCode'] && bw_technologies;

--a/b testing present
update ecommerce_data set ab_testing_present = 't' where 
	array['Optimizely', 'Visual Website Optimizer', 'Mixpanel', 'Omniture Adobe Test and Target', 'Google Content Experiments', 'KISSmetrics', 'Adobe Target Standard', 'Maxymiser', 'Monetate', 'AB Tasty', 'Improvely', 'Google Website Optimizer', 'Google Optimize 360', 'Roistat', 'Dynamic Yield', 'Marketizator', 'Convert', 'Kameleoon', 'SiteSpect', 'Zarget'] && bw_technologies;

-- --cart abandment
-- update ecommerce_data set cart_abandment_present = 't' where 
-- 	array['TeaLeaf', 'Econda', 'Yieldify', 'PicReel', 'ShopBack', 'SaleCycle', 'Conversions on Demand', 'CartStack', 'UpSellit', 'Cloud IQ', 'Qubit Deliver', 'Barilliance', 'Triggered Messaging', 'Commerce Sciences', 'SeeWhy', 'Sub2 Technologies', 'BrainSINS', 'GhostMonitor', 'AbandonAid', 'Retention Science'] && bw_technologies;

--fraud prevention
update ecommerce_data set fraud_prevention = 't' where 
	array['Pixalate', 'Fraudlogix', 'Sift Science', 'Improvely', 'iovation', 'Clearsale', 'Riskified', 'ThreatMetrix', 'Signifyd', 'FruadLabs Pro', 'Inuvo', 'ClickProtector', 'Fireblade', 'Adwatcher', 'Oxford Biochronometrics', 'Vericlix','Who''s Clicking Who'] && bw_technologies;

--personalization
update ecommerce_data set personalization_software = 't' where 
	array['Optimizely', 'Shareaholic', 'Bazaarvoice', 'Nosto', 'CQuotient', 'Monetate', 'Dynamic Yield', 'Convert', 'Qubit Deliver', 'Triggered Messaging', 'Unbxd', 'Baynote', 'Target2Sell', 'BrainSINS', 'BrightInfo', 'Visilabs', 'CoolaData', 'LiftIgniter', 'Strands', 'Traqli'] && bw_technologies;

--shipping provider
update ecommerce_data set shipping_provider = 't' where 
	array['FastSpring'] && bw_technologies;

update ecommerce_data set ecommerce_solution =
public.array_intersect(array['Interchange', 'Miva Merchant', 'GekoSale', 'Spree', 'Shopify', 'PlentyMarkets', 'Drupal Commerce', 'Spark Pay', 'Web Shop Manager', 'WooCommerce Add To Cart', 'Demandware', 'ShopGate', '3D Cart', 'K-eCommerce', 'Big Cartel', 'OXID Eshop Enterprise', 'Magento Enterprise', 'Hybris', 'WooCommerce 2.3', 'WP eCommerce', 'TomatoCart', 'GoDaddy Online Store', 'ProductCart', 'NetSuite eCommerce', 'Actinic', 'Easy Digital Downloads', 'IBM Websphere Commerce', 'MarketPress', 'Volusion', 'PrestaShop', 'Nexternal', 'Loaded Commerce', 'WooCommerce 2.2', 'E-junkie', 'Etsy', 'Visualsoft', 'nopCommerce', 'Magento 1.6', 'ePages', 'Shopify Conversions', 'Shopify British Pound', 'WellCommerce', 'Hextom', 'VTEX', 'OpenCart', 'Shopware', 'Weebly eCommerce', 'AbleCommerce', 'ECSHOP', 'CubeCart', 'Magento 2', 'CoreCommerce', 'Magento 1.9', 'Magento 1.8', 'WordPress eStore Plugin', 'UltraCart', 'Magento 1.7', 'Yahoo Store', 'Shopify Buy Button', 'InSales', 'Zen Cart', 'Wix Stores', 'VirtueMart', 'Cart66', 'Oracle Commerce', 'OXID EShop Community', 'GetShopped', 'SmartStore.NET', 'Magento', 'Ubercart', 'BigCommerce', 'Pinnacle Cart', 'GoDaddy Quick Shopping Cart', 'Shopify US Dollar', 'Shopify Plus', 'osCommerce'] ,bw_technologies);

--ecommerce plugin (eg: plugin to convert blog to ecommerce site etc)
update ecommerce_data set ecommerce_plugin =
public.array_intersect(array['FotoMoto', 'Codeblackbelt', 'WooCommerce', 'Twigmo', 'Cashie Commerce', 'Hextom', 'ShopperPress', 'WordPress eStore Plugin', 'Ecwid', 'Sellfy', 'iJoomla ECommerce', 'AceShop OpenCart', 'Shoprocket', 'GetShopped', 'update ecommerce_data set recomm_collab_filter = 't' where 
	array['Trustpilot', 'Nosto', 'ForeSee Results', 'ScarabResearch', 'Retail Rocket', 'SLI Systems', 'Nextopia', 'Econda', 'Certona', 'Rees46', 'Clerk', 'Commerce Sciences', 'chaordic', 'Baynote', 'Target2Sell', 'BrainSINS', 'RecoPick', 'Blueknow', 'BrainPad Rtoaster', 'Segmentify'] && bw_technologies;

